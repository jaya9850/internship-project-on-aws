const AWS = require('aws-sdk');
const s3 = new AWS.S3();
const BUCKET_NAME = 'contact-form-storage-0911';

exports.handler = async (event) => {
    const body = JSON.parse(event.body);
    const timestamp = new Date().toISOString();
    const data = { ...body, timestamp };
    const params = {
        Bucket: BUCKET_NAME,
        Key: `contact-form-${timestamp}.json`,
        Body: JSON.stringify(data),
        ContentType: 'application/json',
    };
    try {
        await s3.putObject(params).promise();
        return { statusCode: 200, body: JSON.stringify({ message: 'Form data saved successfully!' }) };
    } catch (err) {
        return { statusCode: 500, body: JSON.stringify({ message: 'Failed to save form data' }) };
    }
};
